Ниже описано то, как можно автоматически обновлять ресурсы/завершать работу [контекстов](./STEPS.MD#Контекст).

## Оглавление
- [Обновление](#Обновление)
- [Сброс / Остановка](#Сброс--Остановка)

## Обновление

Часто бывает необходимо, чтобы перед началом теста / перед выполнением первого метода в цепочке `@Before*`-методов 
используемые контексты были обновлены, т.е. сброшены состояния каких-либо объектов, полученные благодаря ранее 
выполненным тестам, очищена накопленная после предыдущих тестов информация, и т.д. 

Для того чтобы была возможность выполнять такое обновление автоматически, если для какого-либо контекста это 
действительно нужно, 

```java
package org.my.pack;

import ru.tinkoff.qa.neptune.core.api.cleaning.ContextRefreshable;
import ru.tinkoff.qa.neptune.core.api.steps.context.Context;

public class MyTestContext extends Context<MyTestContext>
        implements ContextRefreshable { // <---Необходимо реализовать данный интерфейс
    
    @Override
    public void refreshContext() {
        //логика обновления ресурсов, занятых объектом контекста,
        //или обновления внутренних объектов, инкапсулированных объектом контекста
    }
}

```

Частота вызова такого обновления реализуются по-разному:

- [TestNG](./../../../testng.integration/doc/rus/README.MD#Настройки)
- [JUnit5](./../../../jupiter.integration/doc/rus/README.MD#Настройки) 

[к оглавлению документа](#Оглавление) [к списку документов](README.MD#Оглавление)

## Сброс / Остановка

Объекты контекстов могут создавать различные подключения, открывать браузеры, использовать различные внешние ресурсы 
и т.д. Все это необходимо освобождать когда все тесты в наборе завершились, либо (в случае выполнения тестов в 
многопоточном режиме) если какие-либо из тестовых потоков завершились, и объекты контекстов (следовательно, созданные 
подключения, занятые ресурсы и т.д.), созданные для этих потоков, простаивают продолжительное время.


Для того чтобы была возможность выполнять такое освобождение ресурсов автоматически, если для какого-либо контекста это
действительно нужно, 

```java
package org.my.pack;

import ru.tinkoff.qa.neptune.core.api.cleaning.Stoppable;
import ru.tinkoff.qa.neptune.core.api.steps.context.Context;

public class MyTestContext extends Context<MyTestContext>
        implements Stoppable { // <---Необходимо реализовать данный интерфейс
    
    @Override
    public void stop() {
        //логика освобождения ресурсов, занятых объектом контекста,
        //или уничтожения внутренних объектов, инкапсулированных объектом контекста
    }
}
```

И теперь:
- освобождение ресурсов, занятых объектами описанного выше класса, будет происходить автоматически при завершении всех 
  тестов в наборе (съюте)
- если указать [настройки](./SETTINGS.MD#Освобождение-ресурсов) в переменных среды / _neptune.properties_ / 
  _neptune.global.properties_, то станет возможным автоматическое освобождение ресурсов, занятых объектом описанного 
  выше класса, при простое.

[к оглавлению документа](#Оглавление) [к списку документов](README.MD#Оглавление)
